{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/home/arpine_h/projects/live-now/src/Photo.tsx\";\nimport React, { Component } from 'react';\nimport { ReactComponent as Logo } from \"@svgr/webpack?-svgo,+titleProp,+ref!./images/logo.svg\";\nimport { ReactComponent as Lines } from \"@svgr/webpack?-svgo,+titleProp,+ref!./images/three-horizontal-lines.svg\";\nconst videoResolution = {\n  width: 300,\n  height: 300\n};\nvar Views;\n\n(function (Views) {\n  Views[\"account\"] = \"ACCOUNT\";\n  Views[\"register\"] = \"REGISTER\";\n  Views[\"photo\"] = \"PHOTO\";\n})(Views || (Views = {}));\n\nexport default class Photo extends Component {\n  constructor(...args) {\n    super(...args);\n    this.videoRef = /*#__PURE__*/React.createRef();\n    this.videoCanvasRef = /*#__PURE__*/React.createRef();\n    this.video = void 0;\n    this.streams = [];\n\n    this.takePhoto = () => {\n      const videoWidth = videoResolution.width;\n      const videoHeight = videoResolution.height;\n      const canvas = document.getElementById(\"canvas\");\n      const ctx = canvas.getContext('2d');\n      canvas.width = videoHeight;\n      canvas.height = videoWidth;\n      console.log(ctx);\n      if (ctx) ctx.drawImage(this.video, 0, 0, videoHeight, videoWidth, 0, 0, videoHeight, videoWidth);\n      this.stopVideo();\n      const data = canvas.toDataURL('image/jpeg');\n      return data;\n    };\n\n    this.stopVideo = () => {\n      try {\n        this.streams.forEach(stream => {\n          stream.getTracks().forEach(a => {\n            a.stop();\n          });\n        });\n        this.streams = [];\n      } catch (err) {\n        console.log('stopVideo error', err);\n      }\n    };\n  }\n\n  componentDidMount() {\n    this.video = this.videoRef.current;\n    this.showVideo();\n  }\n\n  showVideo() {\n    const video = {\n      width: videoResolution.width,\n      height: videoResolution.height\n    };\n    window.navigator.mediaDevices.getUserMedia({\n      video,\n      audio: false\n    }).then(stream => {\n      if (stream === null) return;\n      this.video.srcObject = stream;\n      this.streams.push(stream);\n\n      try {\n        this.video.play();\n      } catch (err) {\n        console.log(err);\n        return;\n      }\n    }).catch(err => {\n      console.log(err);\n    });\n  }\n\n  render() {\n    const {\n      setView\n    } = this.props;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"photo-component\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"header\",\n        children: [/*#__PURE__*/_jsxDEV(Logo, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"lines\",\n          role: \"button\",\n          onKeyUp: () => setView(Views.register),\n          onClick: () => setView(Views.register),\n          children: /*#__PURE__*/_jsxDEV(Lines, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"main\",\n        children: [/*#__PURE__*/_jsxDEV(\"canvas\", {\n          id: \"canvas\",\n          ref: this.videoCanvasRef,\n          children: /*#__PURE__*/_jsxDEV(\"video\", {\n            className: \"\",\n            ref: this.videoRef\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 6\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"buttons-section\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"button\",\n            type: \"button\",\n            onKeyUp: () => this.takePhoto(),\n            onClick: () => this.takePhoto()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 4\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["/home/arpine_h/projects/live-now/src/Photo.tsx"],"names":["React","Component","videoResolution","width","height","Views","Photo","videoRef","createRef","videoCanvasRef","video","streams","takePhoto","videoWidth","videoHeight","canvas","document","getElementById","ctx","getContext","console","log","drawImage","stopVideo","data","toDataURL","forEach","stream","getTracks","a","stop","err","componentDidMount","current","showVideo","window","navigator","mediaDevices","getUserMedia","audio","then","srcObject","push","play","catch","render","setView","props","register"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { ReactComponent as Logo } from './images/logo.svg';\nimport { ReactComponent as Lines } from './images/three-horizontal-lines.svg';\n\nconst videoResolution = { width: 300, height: 300 };\n\ntype Props = {\n\tappState: any,\n\tsetView: any,\n}\n\nenum Views {\n\taccount = 'ACCOUNT'\n\t, register = 'REGISTER'\n\t, photo = 'PHOTO'\n}\n\nexport default class Photo extends Component<Props> {\n\tprivate videoRef = React.createRef<HTMLVideoElement>();\n\tprivate videoCanvasRef = React.createRef<HTMLCanvasElement>();\n\tprivate video: any;\n\t// private canvas = document.createElement('canvas');\n\tprivate streams: any[] = [];\n\n\tcomponentDidMount() {\n\t\tthis.video = this.videoRef.current as any;\n\n\t\tthis.showVideo();\n\t}\n\n\tshowVideo() {\n\t\tconst video: any = {\n\t\t\twidth: videoResolution.width,\n\t\t\theight: videoResolution.height,\n\t\t};\n\t\twindow.navigator.mediaDevices.getUserMedia({\n\t\t\tvideo,\n\t\t\taudio: false,\n\t\t}).then((stream) => {\n\t\t\tif (stream === null) return;\n\t\t\tthis.video.srcObject = stream;\n\t\t\tthis.streams.push(stream);\n\t\t\ttry {\n\t\t\t\tthis.video.play();\n\t\t\t} catch (err) {\n\t\t\t\tconsole.log(err);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}).catch((err) => {\n\t\t\tconsole.log(err);\n\t\t});\n\t}\n\n\ttakePhoto = () => {\n\t\tconst videoWidth = videoResolution.width;\n\t\tconst videoHeight = videoResolution.height;\n\t\tconst canvas = document.getElementById(\"canvas\") as HTMLCanvasElement;\n    const ctx = canvas.getContext('2d');\n\t\tcanvas.width = videoHeight;\n\t\tcanvas.height = videoWidth;\n\t\tconsole.log(ctx)\n\t\tif (ctx) ctx.drawImage(this.video, 0, 0, videoHeight, videoWidth, 0, 0, videoHeight, videoWidth);\n\t\tthis.stopVideo();\n\n\t\tconst data = canvas.toDataURL('image/jpeg');\n    return data;\n\t}\n\n\tstopVideo = (): void => {\n    try {\n      this.streams.forEach((stream: any) => {\n        stream.getTracks().forEach((a: any) => {\n          a.stop();\n        });\n      });\n      this.streams = [];\n    } catch (err) {\n      console.log('stopVideo error', err);\n    }\n  }\n\n\trender() {\n\t\tconst { setView } = this.props;\n\n\t\treturn (\n\t\t\t<div className='photo-component'>\n\t\t\t\t<div className=\"header\">\n\t\t\t\t\t<Logo />\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"lines\"\n\t\t\t\t\t\trole=\"button\"\n\t\t\t\t\t\tonKeyUp={() => setView(Views.register)}\n\t\t\t\t\t\tonClick={() => setView(Views.register)}\n\t\t\t\t\t><Lines /></div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"main\">\n\t\t\t\t\t<canvas id=\"canvas\" ref={this.videoCanvasRef}>\n\t\t\t\t\t<video className=\"\" ref={this.videoRef}></video>\n\t\t\t\t\t</canvas>\n\t\t\t\t\t<div className=\"buttons-section\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclassName=\"button\"\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tonKeyUp={() => this.takePhoto()}\n\t\t\t\t\t\t\tonClick={() => this.takePhoto()}\n\t\t\t\t\t\t></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n"]},"metadata":{},"sourceType":"module"}